<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/template.xhtml">
	<ui:define name="contenido">
		<section class="hero animate__animated animate__fadeIn"
			style="margin-top:2rem;">
		<h2 class="display-4 mb-3 fw-bold">❓ Problemas y Retos</h2>
		<p class="lead mb-4">
			Resuelve ejercicios, comparte soluciones y aprende en comunidad.<br />
			¿Te animas a un nuevo desafío?
		</p>
		</section>
		<section class="cards container animate__animated animate__fadeInUp"
			style="margin-bottom:2rem;">
		<div class="row justify-content-center">
			<div class="col-md-4 mb-3">
				<div class="card text-center py-4 px-2 h-100 card-problemas">
					<i class="fa-solid fa-square-root-variable card-icon"></i>
					<h5 class="mt-2">Matemáticas</h5>
					<p>Ejercicios y problemas de lógica y álgebra.</p>
					<h:commandButton value="Ver problemas"
						action="#{paginaprincipalbean.irProblemas}"
						styleClass="btn btn-sm" />
				</div>
			</div>
			<div class="col-md-4 mb-3">
				<div class="card text-center py-4 px-2 h-100 card-problemas">
					<i class="fa-solid fa-code card-icon"></i>
					<h5 class="mt-2">Programación</h5>
					<p>Retos prácticos para mejorar tus habilidades de código.</p>
					<h:commandButton value="Ver problemas"
						action="#{paginaprincipalbean.irProblemas}"
						styleClass="btn btn-sm" />
				</div>
			</div>
			<div class="col-md-4 mb-3">
				<div class="card text-center py-4 px-2 h-100 card-problemas">
					<i class="fa-solid fa-microchip card-icon"></i>
					<h5 class="mt-2">Electrónica</h5>
					<p>Soluciona circuitos y experimenta con tecnología.</p>
					<h:commandButton value="Ver problemas"
						action="#{paginaprincipalbean.irProblemas}"
						styleClass="btn btn-sm" />
				</div>
			</div>
		</div>
		</section>

		<!-- NUEVO: CRUD PROBLEMAS ESTILO INTEGRADO -->
		<div class="main-content">
			<section class="home section active" id="home">
			<div class="container">
				<div class="row">
					<div class="home-info padd-15">
						<h3 class="hello">
							Artemisa UEB <span class="name">Sergio - Camilo - Jeisson
								- Luna</span>
						</h3>
						<h3 class="profession">
							Hola, <span class="typing">Bienvenido :) </span>
						</h3>
						<p class="animate__animated animate__lightSpeedInRight">“Soy
							Artemisa UEB. Aquí encontrarás información, documentos y los
							mejores consejos para despertar y potenciar tu programador
							interior.”</p>
						<!-- === FORM PRINCIPAL === -->
						<h:form id="form">
							<p:growl id="msgs" showDetail="true" life="5000" />

							<!-- FAB -->
							<p:commandButton id="fabNuevo" icon="pi pi-plus"
								styleClass="ui-button-rounded ui-button-help fab" type="button"
								onclick="PF('dlgNuevoProblema').show()" />

							<!-- DIALOG CREAR -->
							<p:dialog id="dlgNuevoProblema" header="Nuevo problema"
								widgetVar="dlgNuevoProblema" modal="false"
								dismissableMask="true" draggable="false" resizable="false"
								closeOnEscape="true" styleClass="w-30rem">

								<p:messages id="msgsDlg" showDetail="true" closable="true" />

								<div class="p-fluid grid">
									<div class="col-12">
										<p:outputLabel for="nombre" value="Nombre / Título *" />
										<p:inputText id="nombre" value="#{problemaBean.titulo}"
											maxlength="150" required="true"
											requiredMessage="El título es obligatorio" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="dificultad" value="Dificultad (número) *" />
										<p:inputNumber id="dificultad"
											value="#{problemaBean.dificultad}" decimalPlaces="0"
											required="true"
											requiredMessage="La dificultad es obligatoria" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="tema" value="Tema" />
										<p:inputText id="tema" value="#{problemaBean.tema}"
											maxlength="80" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="juez" value="Juez" />
										<p:inputText id="juez" value="#{problemaBean.juez}"
											maxlength="60" placeholder="DOMJudge / CodeChef / UVA..." />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="link" value="Link" />
										<p:inputText id="link" value="#{problemaBean.link}"
											maxlength="255" placeholder="https://..." />
									</div>

									<div class="col-12 d-flex gap-2 justify-content-end">
										<p:commandButton value="Cancelar" type="button"
											onclick="PF('dlgNuevoProblema').hide()" />
										<p:commandButton value="Crear" icon="pi pi-check"
											action="#{problemaBean.crear}" process="@form"
											update=":form:tabla :form:msgs"
											oncomplete="PF('dlgNuevoProblema').hide();" />
									</div>
								</div>
							</p:dialog>

							<!-- Botón Listar -->
							<div class="mb-2">
								<p:commandButton value="Listar problemas"
									action="#{problemaBean.listarProblemas}" process="@this"
									update=":form:tabla :form:msgs" icon="pi pi-list" />
							</div>

							<!-- TABLA TIPADA -->
							<p:dataTable id="tabla" value="#{problemaBean.lista}" var="p"
								rows="10" paginator="true"
								emptyMessage="No hay problemas para mostrar"
								styleClass="container" responsiveLayout="scroll">

								<p:column headerText="ID" style="width:6rem; text-align:center;">
									<h:outputText value="#{p.id}" />
								</p:column>

								<p:column headerText="Título">
									<h:outputText value="#{p.titulo}" />
								</p:column>

								<p:column headerText="Dificultad"
									style="width:8rem; text-align:center;">
									<h:outputText value="#{p.dificultad}" />
								</p:column>

								<p:column headerText="Tema">
									<h:outputText value="#{p.tema}" />
								</p:column>

								<p:column headerText="Juez" style="width:10rem;">
									<h:outputText value="#{p.juez}" />
								</p:column>

								<p:column headerText="Acción"
									style="width:1%; white-space:nowrap;" exportable="false">
									<p:commandButton value="Abrir" icon="pi pi-external-link"
										onclick="window.open('#{p.link}','_blank'); return false;"
										disabled="#{empty p.link}" />
								</p:column>
							</p:dataTable>
						</h:form>
					</div>
				</div>
			</div>
			</section>
		</div>

		<section class="hero"
			style="background: var(--rosa-claro); color: #d6336c;">
		<h2>¿Tienes un reto para compartir?</h2>
		<p>Propón tu propio problema y ayuda a otras a aprender.</p>
		<h:link outcome="problemas" styleClass="btn btn-lg"
			style="background:var(--naranja);color:white;border-radius:30px;">
                Proponer reto
            </h:link> </section>
	</ui:define>
</ui:composition>
</html>