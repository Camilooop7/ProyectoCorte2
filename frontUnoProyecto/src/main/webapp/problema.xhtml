<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
    data-bs-theme="light">

<h:head>
	<meta charset="UTF-8" />
	<title>artemisa</title>

	<link rel="icon" href="https://cdn-icons-png.flaticon.com/512/5520/5520840.png" />
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

	<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />
	<link href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@1.0.4/css/bulma.min.css" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" />
	<link rel="stylesheet" href="css/styleproblema.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" />

	<style>
.fab { position: fixed; right: 1.25rem; bottom: 1.25rem; width: 3.25rem; height: 3.25rem; box-shadow: 0 8px 20px rgba(0,0,0,.2); z-index: 1050; }
.ui-widget-overlay { z-index: 1100 !important; }
.ui-dialog { z-index: 1110 !important; }
@media (max-width: 768px){ .w-30rem { width: 100% !important; } }

.theme-fab{ position: fixed; right: 16px; top: 80px; z-index: 3000; border-radius: 999px; padding: 10px 14px; box-shadow: 0 8px 20px rgba(0,0,0,.15); }

html[data-bs-theme="dark"] body,
html[data-bs-theme="dark"] .section,
html[data-bs-theme="dark"] .main-content,
html[data-bs-theme="dark"] .container,
html[data-bs-theme="dark"] .card,
html[data-bs-theme="dark"] .p-panel,
html[data-bs-theme="dark"] .ui-panel,
html[data-bs-theme="dark"] .p-datatable,
html[data-bs-theme="dark"] .ui-datatable,
html[data-bs-theme="dark"] .ui-dialog,
html[data-bs-theme="dark"] .ui-widget-content {
  background-color: #000 !important;
  color: #fff !important;
}

html[data-bs-theme="dark"] .p-datatable thead th,
html[data-bs-theme="dark"] .ui-datatable thead th {
  background-color: #000 !important; color: #fff !important; border-color: #222 !important;
}
html[data-bs-theme="dark"] .p-datatable tbody td,
html[data-bs-theme="dark"] .ui-datatable tbody td {
  background-color: #000 !important; color: #fff !important; border-color: #222 !important;
}

html[data-bs-theme="dark"] .ui-dialog .ui-dialog-titlebar,
html[data-bs-theme="dark"] .p-panel .p-panel-header,
html[data-bs-theme="dark"] .ui-panel .ui-panel-titlebar {
  background-color: #000 !important; color: #fff !important; border-color: #222 !important;
}

html[data-bs-theme="dark"] input, 
html[data-bs-theme="dark"] textarea, 
html[data-bs-theme="dark"] .p-inputtext, 
html[data-bs-theme="dark"] .ui-inputfield {
  background-color: #000 !important; color: #fff !important; border-color: #444 !important;
}
	</style>
</h:head>

<h:body>

	<div class="main-container">
		<div class="aside">
			<div class="logo">
				<a href="#"><span>A</span>rtemisa <br /> <br /> <span>UEB</span></a>
			</div>

			<div class="nav-toggler">
				<span></span>
			</div>

			<ul class="nav">
				<li><a href="menu.xhtml" class="active"><i class="fa fa-home"></i>Home</a></li>
				<li><a href="temario.xhtml"><i class="bi bi-card-heading"></i>Temario</a></li>
				<li><a href="problema.xhtml"><i class="bi bi-balloon-heart"></i>Problemas</a></li>
				<li><a href="libro.xhtml"><i class="bi bi-book-half"></i>Libros</a></li>
				<li><a href="link.xhtml"><i class="bi bi-link"></i>Links Valiosos</a></li>
				<li><a href="cronograma.xhtml"><i class="bi bi-calendar-week"></i>Eventos</a></li>

				<div class="card">
					<h:form>
						<p:growl id="messages" showDetail="true" />
						<p:menuButton value="Opción">
							<p:menuitem value="Judge" url="https://domjudgeacademicueb.com/public" icon="bi bi-code-square" />
							<p:menuitem value="CodeChef" url="https://www.codechef.com/" icon="bi bi-cookie" />
							<p:menuitem value="Vjudge" url="https://vjudge.net/group/cuevadelprofdiego" icon="bi bi-emoji-angry" />
							<p:menuitem value="OnlineJudge" url="https://onlinejudge.org/" icon="bi bi-joystick" />
						</p:menuButton>
					</h:form>
				</div>
			</ul>
		</div>

		<div class="main-content">
			<section class="home section active" id="home">
			<div class="container">
				<div class="row">
					<div class="home-info padd-15">
						<h3 class="hello">Artemisa UEB <span class="name">Sergio - Camilo - Jeisson - Luna</span></h3>
						<h3 class="profession">Hola, <span class="typing">Bienvenido :) </span></h3>
						<p class="animate__animated animate__lightSpeedInRight">“Soy Artemisa UEB. Aquí encontrarás información, documentos y los mejores consejos para despertar y potenciar tu programador interior.”</p>

						<h:form id="form" width="1500">
							<p:growl id="msgs" showDetail="true" life="5000" width="1500" autoUpdate="true" />

							<p:commandButton id="fabNuevo" icon="pi pi-plus"
								styleClass="ui-button-rounded ui-button-help fab" type="button"
								onclick="PF('dlgNuevoProblema').show()"
								rendered="#{auth.admin or auth.profesor}" />

							<div class="mb-2 d-flex gap-2">
								<div class="wrapper">
									<p:commandButton styleClass="beton" value="Ver problemas"
										action="#{problemaBean.listarProblemas}" process="@this"
										update=":form:tabla :form:msgs" icon="pi pi-list" />
								</div>
								<p:commandButton value="Eliminar por ID" type="button"
									icon="pi pi-trash" styleClass="ui-button-danger"
									onclick="PF('dlgEliminarProblema').show()"
									rendered="#{auth.admin or auth.profesor}" />
							</div>

							<br/>

							<p:dataTable id="tabla" value="#{problemaBean.lista}" var="p"
								rows="10" paginator="true"
								emptyMessage="No hay problemas para mostrar" style="width:100%"
								tableStyle="width:100%; table-layout:auto;" responsiveLayout="scroll">

								<p:column headerText="ID" style="width:6rem; text-align:center;">
									<h:outputText value="#{p.id}" />
								</p:column>

								<p:column headerText="Título">
									<h:outputText value="#{p.titulo}" />
								</p:column>

								<p:column headerText="Dificultad" style="width:8rem; text-align:center;">
									<h:outputText value="#{p.dificultad}" />
								</p:column>

								<p:column headerText="Tema">
									<h:outputText value="#{p.tema}" />
								</p:column>

								<p:column headerText="Juez" style="width:10rem;">
									<h:outputText value="#{p.juez}" />
								</p:column>

								<p:column headerText="Acción" style="width:1%; white-space:nowrap;" exportable="false">
									<p:commandButton value="Abrir" icon="pi pi-external-link"
										onclick="window.open('#{p.link}','_blank'); return false;"
										disabled="#{empty p.link}" />
								</p:column>
							</p:dataTable>
						</h:form>

						<p:dialog id="dlgNuevoProblema" header="Nuevo problema"
							widgetVar="dlgNuevoProblema" modal="false" dismissableMask="true"
							draggable="false" resizable="false" closeOnEscape="true"
							styleClass="w-30rem" rendered="#{auth.admin or auth.profesor}">
							<h:form id="newForm">
								<p:messages id="msgsDlg" showDetail="true" closable="true" />

								<div class="p-fluid grid">
									<div class="col-12">
										<p:outputLabel for="nombre" value="Nombre / Título *" />
										<p:inputText id="nombre" value="#{problemaBean.titulo}" maxlength="150" required="true" requiredMessage="El título es obligatorio" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="dificultad" value="Dificultad (número) *" />
										<p:inputNumber id="dificultad" value="#{problemaBean.dificultad}" decimalPlaces="0" required="true" requiredMessage="La dificultad es obligatoria" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="tema" value="Tema" />
										<p:inputText id="tema" value="#{problemaBean.tema}" maxlength="80" />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="juez" value="Juez" />
										<p:inputText id="juez" value="#{problemaBean.juez}" maxlength="60" placeholder="DOMJudge / CodeChef / UVA..." />
									</div>

									<div class="col-12 md:col-6">
										<p:outputLabel for="link" value="Link" />
										<p:inputText id="link" value="#{problemaBean.link}" maxlength="255" placeholder="https://..." />
									</div>

									<div class="col-12 d-flex gap-2 justify-content-end">
										<p:commandButton value="Cancelar" type="button" onclick="PF('dlgNuevoProblema').hide()" />
										<p:commandButton value="Crear" icon="pi pi-check"
											action="#{problemaBean.crear}" process="@form"
											update=":form:tabla :form:msgs"
											oncomplete="if(!args.validationFailed) PF('dlgNuevoProblema').hide();" />
									</div>
								</div>
							</h:form>
						</p:dialog>

						<p:dialog id="dlgEliminarProblema" header="Eliminar problema por ID"
							widgetVar="dlgEliminarProblema" modal="true" closable="true" resizable="false"
							appendTo="@(body)" rendered="#{auth.admin or auth.profesor}">
							<h:form id="delForm">
								<p:messages id="dlgMsgs" for="@form" showDetail="true" closable="true" />
								<h:panelGrid columns="2" columnClasses="col-4,col-8" cellpadding="6">
									<p:outputLabel for="delId" value="ID a eliminar *" />
									<p:inputNumber id="delId" value="#{problemaBean.deleteId}"
										minValue="1" decimalPlaces="0" required="true"
										requiredMessage="Ingresa un ID válido" />
								</h:panelGrid>

								<div class="d-flex justify-content-end gap-2 mt-2">
									<p:commandButton value="Eliminar" icon="pi pi-check"
										styleClass="ui-button-danger" process="@form"
										action="#{problemaBean.eliminarById}"
										update="delForm dlgMsgs :form:msgs :form:tabla"
										oncomplete="if(!args.validationFailed) PF('dlgEliminarProblema').hide()"
										resetValues="true" />
									<p:commandButton value="Cancelar" icon="pi pi-times" type="button"
										styleClass="ui-button-secondary ui-button-outlined"
										onclick="PF('dlgEliminarProblema').hide()" />
								</div>
							</h:form>
						</p:dialog>

					</div>
				</div>
			</div>

			<aside class="loader" style="--wh-number: 24;">
			  <div class="pixel"></div>
			</aside>

			</section>
		</div>
	</div>

	<button id="themeFab" class="btn btn-primary theme-fab" title="Cambiar tema">
	  <i class="bi bi-moon-stars"></i>
	</button>

	<script>
	  (function(){
	    const html = document.documentElement;
	    const btn  = document.getElementById('themeFab');

	    if(!html.hasAttribute('data-bs-theme')) {
	      html.setAttribute('data-bs-theme','light');
	    }

	    const setLabel = (theme) => {
	      btn.innerHTML = theme === 'dark'
	        ? '<i class="bi bi-sun"></i>'
	        : '<i class="bi bi-moon-stars"></i>';
	      btn.setAttribute('title', theme === 'dark' ? 'Modo claro' : 'Modo oscuro');
	    };

	    const saved = localStorage.getItem('theme');
	    if (saved === 'dark' || saved === 'light') {
	      html.setAttribute('data-bs-theme', saved);
	    }
	    setLabel(html.getAttribute('data-bs-theme'));

	    btn.addEventListener('click', () => {
	      const next = html.getAttribute('data-bs-theme') === 'light' ? 'dark' : 'light';
	      html.setAttribute('data-bs-theme', next);
	      localStorage.setItem('theme', next);
	      setLabel(next);
	    });
	  })();
	</script>

</h:body>
</html>
